<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Reviews - Student Shala</title>
  <link rel="stylesheet" href="assets/css/style.css">
</head>
<body>

  <!-- ✅ Navbar -->
  <header class="navbar">
    <div class="logo"><img src="assets/images/logo.png"><h2>Student Shala</h2></div>
    <nav class="menu">
      <a href="index.html">Home</a>
      <a href="pg-listing.html">PG Listings</a>
      <a href="booking.html">Bookings</a>
      <a href="payment.html">Payment</a>
      <a href="agreement.html">Agreement</a>
      <a href="reviews.html" class="active">Reviews</a>
    </nav>
    <div class="search-login">
      <div class="search-bar">
        <input type="text" placeholder="Search PG nearby...">
        <button class="btn">Search</button>
      </div>
      <a href="login.html" class="btn login-btn">Login</a>
    </div>
  </header>

  <main class="review-container">
    <div class="container-page">
    <h2 class="page-title">PG Reviews</h2>

    <form class="form" id="reviewForm">
      <div class="row">
        <div class="input">
          <label for="pg">PG</label>
          <select id="pg"></select>
        </div>
        <div class="input">
          <label for="rating">Rating</label>
          <select id="rating" required>
            <option value="">Select</option>
            <option>5</option><option>4</option><option>3</option><option>2</option><option>1</option>
          </select>
        </div>
      </div>
      <div class="row full">
        <div class="input">
          <label for="review">Review</label>
          <textarea id="review" placeholder="Share your experience..." required></textarea>
        </div>
      </div>
      <div class="actions"><button class="btn" type="submit">Submit Review</button></div>
    </form>

    <h3 class="page-title" style="margin-top:16px;">Recent Reviews</h3>
    <div class="cards" id="reviewsList"></div>
  </div>

  <script src="js/script.js"></script>
  <script>
    // Fill PG dropdown
    const pgSelect = document.getElementById('pg');
    StudentShala.pgLocations.forEach(p => {
      const opt = document.createElement('option');
      opt.value = p.id; opt.textContent = p.name;
      pgSelect.appendChild(opt);
    });

    const listEl = document.getElementById('reviewsList');
    const load = () => {
      const items = JSON.parse(localStorage.getItem('reviews')||'[]').reverse();
      listEl.innerHTML = items.map(r => `
        <div class="card">
          <h3>${r.pgName} — ⭐ ${r.rating}</h3>
          <p>${r.text}</p>
          <p class="meta">${new Date(r.date).toLocaleString()}</p>
        </div>
      `).join('') || '<p>No reviews yet.</p>';
    };
    load();

    document.getElementById('reviewForm').addEventListener('submit',(e)=>{
      e.preventDefault();
      const pgId = Number(pgSelect.value);
      const pg = StudentShala.pgLocations.find(p => p.id===pgId);
      const rating = document.getElementById('rating').value;
      const text = document.getElementById('review').value.trim();

      const items = JSON.parse(localStorage.getItem('reviews')||'[]');
      items.push({ pgId, pgName: pg?.name, rating, text, date: Date.now() });
      localStorage.setItem('reviews', JSON.stringify(items));
      e.target.reset(); load();
    });
  </script>
  </main>
</body>
</html>
